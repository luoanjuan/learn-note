##  消息队列

#### 优点
- 解耦：如果系统需要引用直接订阅，生产者无需改动代码，不是强依赖的话，一个系统挂了不影响
- 异步：提高响应时间，牺牲了一致性
- 削峰：可以在不添加服务器的情况下不拒绝请求

#### 缺点
-  系统可用性：mq挂全挂 
-  提高了系统复杂性，消息堆积、消息重复、消息顺序 
-  一致性问题：各个步骤都需完成，但是可能某一个步骤失败。

#### 选型

| 特性| ActiveMQ | RabbitMQ | RocketMQ | Kafka |
|---|---|---|---|---|
| 单机吞吐量|万级|万级|10万级，topic可以到达几百，几千，吞吐量有较小的下降|10万级，topic从几十个到几百个的时候吞吐量有较大的下降|
|时效性|ms级|微秒级，这个是RabbitMQ优势|ms级|ms级以内|
|可用性|高，基于主从架构提高可用性|高，基于主从架构提高可用性|非常高，分布式架构|非常高，分布式，一个数据多副本|
|消息可靠性|有较低的概率丢失数据||经过参数优化配置，可以做到0丢失|经过参数优化配置，可以做到消息0丢失|
|核心特点|MQ领域的功能机器完备|基于erlang开发，虽有并发能力很强，性能机极其好、延时性低|MQ功能较为完善，还是分布式，扩展性好|功能较为简单，主要支持简单的MQ功能，在大数据领域的实时计算以及日志采集被大规模使用|
|优劣势总结|非常成熟，功能强大；低频率丢消息，社区少，官方更新慢|erlang语言开发，性能好，开源管理界面。吞吐量低|接口简单易用，大规模吞吐，分布式扩展也方便，社区维护也可以，可靠性和可用性也OK，还可以维护大规模topic，支持复杂业务场景|仅仅提供较少的核心功能，但是提供超高的吞吐量，ms级延迟，极高的可用性和可靠性，而且分布式可以扩展，但是消息可能重复|

#### 高可用
##### rabbitMQ
- 普通集群模式
- 镜像集群模式：高可用，非分布式，如果数据量大的机器不可以容纳了

##### 重复消息
 

